local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local CoreGui = game:GetService("CoreGui")

local Library = {}
Library.__index = Library

function Library.new(title)
    local self = setmetatable({}, Library)
    
    self.ScreenGui = Instance.new("ScreenGui")
    self.ScreenGui.Name = "SimpleLib"
    self.ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    self.ScreenGui.Parent = CoreGui
    
    self.MainFrame = Instance.new("Frame")
    self.MainFrame.Name = "MainFrame"
    self.MainFrame.Size = UDim2.new(0, 600, 0, 400)
    self.MainFrame.Position = UDim2.new(0.5, -300, 0.5, -200)
    self.MainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 25)
    self.MainFrame.BorderSizePixel = 0
    self.MainFrame.Parent = self.ScreenGui
    
    local UICorner = Instance.new("UICorner")
    UICorner.CornerRadius = UDim.new(0, 8)
    UICorner.Parent = self.MainFrame
    
    self.TopBar = Instance.new("Frame")
    self.TopBar.Name = "TopBar"
    self.TopBar.Size = UDim2.new(1, 0, 0, 40)
    self.TopBar.BackgroundColor3 = Color3.fromRGB(15, 15, 20)
    self.TopBar.BorderSizePixel = 0
    self.TopBar.Parent = self.MainFrame
    
    local TopCorner = Instance.new("UICorner")
    TopCorner.CornerRadius = UDim.new(0, 8)
    TopCorner.Parent = self.TopBar
    
    self.Title = Instance.new("TextLabel")
    self.Title.Name = "Title"
    self.Title.Size = UDim2.new(1, -50, 1, 0)
    self.Title.Position = UDim2.new(0, 15, 0, 0)
    self.Title.BackgroundTransparency = 1
    self.Title.Text = title or "UI Library"
    self.Title.TextColor3 = Color3.fromRGB(255, 255, 255)
    self.Title.TextSize = 16
    self.Title.Font = Enum.Font.GothamBold
    self.Title.TextXAlignment = Enum.TextXAlignment.Left
    self.Title.Parent = self.TopBar
    
    self.CloseButton = Instance.new("TextButton")
    self.CloseButton.Name = "CloseButton"
    self.CloseButton.Size = UDim2.new(0, 30, 0, 30)
    self.CloseButton.Position = UDim2.new(1, -35, 0, 5)
    self.CloseButton.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
    self.CloseButton.Text = "X"
    self.CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    self.CloseButton.TextSize = 14
    self.CloseButton.Font = Enum.Font.GothamBold
    self.CloseButton.Parent = self.TopBar
    
    local CloseCorner = Instance.new("UICorner")
    CloseCorner.CornerRadius = UDim.new(0, 6)
    CloseCorner.Parent = self.CloseButton
    
    self.CloseButton.MouseButton1Click:Connect(function()
        self.ScreenGui:Destroy()
    end)
    
    self.SearchBox = Instance.new("TextBox")
    self.SearchBox.Name = "SearchBox"
    self.SearchBox.Size = UDim2.new(0, 200, 0, 25)
    self.SearchBox.Position = UDim2.new(0.5, -100, 0, 7.5)
    self.SearchBox.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
    self.SearchBox.PlaceholderText = "üîç Search"
    self.SearchBox.PlaceholderColor3 = Color3.fromRGB(150, 150, 150)
    self.SearchBox.Text = ""
    self.SearchBox.TextColor3 = Color3.fromRGB(255, 255, 255)
    self.SearchBox.TextSize = 12
    self.SearchBox.Font = Enum.Font.Gotham
    self.SearchBox.Parent = self.TopBar
    
    local SearchCorner = Instance.new("UICorner")
    SearchCorner.CornerRadius = UDim.new(0, 6)
    SearchCorner.Parent = self.SearchBox
    
    self.TabContainer = Instance.new("Frame")
    self.TabContainer.Name = "TabContainer"
    self.TabContainer.Size = UDim2.new(0, 150, 1, -50)
    self.TabContainer.Position = UDim2.new(0, 10, 0, 45)
    self.TabContainer.BackgroundTransparency = 1
    self.TabContainer.Parent = self.MainFrame
    
    local TabLayout = Instance.new("UIListLayout")
    TabLayout.Padding = UDim.new(0, 5)
    TabLayout.Parent = self.TabContainer
    
    self.ContentFrame = Instance.new("Frame")
    self.ContentFrame.Name = "ContentFrame"
    self.ContentFrame.Size = UDim2.new(1, -170, 1, -50)
    self.ContentFrame.Position = UDim2.new(0, 165, 0, 45)
    self.ContentFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
    self.ContentFrame.BorderSizePixel = 0
    self.ContentFrame.Parent = self.MainFrame
    
    local ContentCorner = Instance.new("UICorner")
    ContentCorner.CornerRadius = UDim.new(0, 6)
    ContentCorner.Parent = self.ContentFrame
    
    self.Tabs = {}
    self.CurrentTab = nil
    
    self:MakeDraggable(self.MainFrame, self.TopBar)
    
    return self
end

function Library:MakeDraggable(frame, dragHandle)
    local dragging, dragInput, dragStart, startPos
    
    dragHandle.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = frame.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local delta = input.Position - dragStart
            frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
end

function Library:CreateTab(name, icon)
    local Tab = {}
    
    local TabButton = Instance.new("TextButton")
    TabButton.Name = name
    TabButton.Size = UDim2.new(1, 0, 0, 40)
    TabButton.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
    TabButton.Text = ""
    TabButton.Parent = self.TabContainer
    
    local TabCorner = Instance.new("UICorner")
    TabCorner.CornerRadius = UDim.new(0, 8)
    TabCorner.Parent = TabButton
    
    local TabIcon = Instance.new("ImageLabel")
    TabIcon.Size = UDim2.new(0, 20, 0, 20)
    TabIcon.Position = UDim2.new(0, 10, 0.5, -10)
    TabIcon.BackgroundTransparency = 1
    TabIcon.Image = icon or "rbxassetid://6031360365"
    TabIcon.ImageColor3 = Color3.fromRGB(200, 200, 200)
    TabIcon.Parent = TabButton
    
    local TabLabel = Instance.new("TextLabel")
    TabLabel.Size = UDim2.new(1, -45, 1, 0)
    TabLabel.Position = UDim2.new(0, 40, 0, 0)
    TabLabel.BackgroundTransparency = 1
    TabLabel.Text = name
    TabLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
    TabLabel.TextSize = 13
    TabLabel.Font = Enum.Font.Gotham
    TabLabel.TextXAlignment = Enum.TextXAlignment.Left
    TabLabel.Parent = TabButton
    
    local TabContent = Instance.new("ScrollingFrame")
    TabContent.Name = name .. "Content"
    TabContent.Size = UDim2.new(1, -10, 1, -10)
    TabContent.Position = UDim2.new(0, 5, 0, 5)
    TabContent.BackgroundTransparency = 1
    TabContent.BorderSizePixel = 0
    TabContent.ScrollBarThickness = 4
    TabContent.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 100)
    TabContent.Visible = false
    TabContent.Parent = self.ContentFrame
    
    local ContentLayout = Instance.new("UIListLayout")
    ContentLayout.Padding = UDim.new(0, 8)
    ContentLayout.Parent = TabContent
    
    ContentLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        TabContent.CanvasSize = UDim2.new(0, 0, 0, ContentLayout.AbsoluteContentSize.Y + 10)
    end)
    
    TabButton.MouseButton1Click:Connect(function()
        for _, tab in pairs(self.Tabs) do
            tab.Button.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
            tab.Icon.ImageColor3 = Color3.fromRGB(200, 200, 200)
            tab.Label.TextColor3 = Color3.fromRGB(200, 200, 200)
            tab.Content.Visible = false
        end
        
        TabButton.BackgroundColor3 = Color3.fromRGB(70, 70, 200)
        TabIcon.ImageColor3 = Color3.fromRGB(255, 255, 255)
        TabLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        TabContent.Visible = true
        self.CurrentTab = Tab
    end)
    
    Tab.Button = TabButton
    Tab.Icon = TabIcon
    Tab.Label = TabLabel
    Tab.Content = TabContent
    Tab.Library = self
    
    function Tab:AddCheckbox(text, default, callback)
        local Checkbox = Instance.new("Frame")
        Checkbox.Name = "Checkbox"
        Checkbox.Size = UDim2.new(1, 0, 0, 30)
        Checkbox.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
        Checkbox.BorderSizePixel = 0
        Checkbox.Parent = TabContent
        
        local CheckCorner = Instance.new("UICorner")
        CheckCorner.CornerRadius = UDim.new(0, 6)
        CheckCorner.Parent = Checkbox
        
        local CheckButton = Instance.new("TextButton")
        CheckButton.Size = UDim2.new(0, 20, 0, 20)
        CheckButton.Position = UDim2.new(0, 8, 0.5, -10)
        CheckButton.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
        CheckButton.Text = ""
        CheckButton.Parent = Checkbox
        
        local ButtonCorner = Instance.new("UICorner")
        ButtonCorner.CornerRadius = UDim.new(0, 4)
        ButtonCorner.Parent = CheckButton
        
        local CheckLabel = Instance.new("TextLabel")
        CheckLabel.Size = UDim2.new(1, -40, 1, 0)
        CheckLabel.Position = UDim2.new(0, 35, 0, 0)
        CheckLabel.BackgroundTransparency = 1
        CheckLabel.Text = text
        CheckLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        CheckLabel.TextSize = 13
        CheckLabel.Font = Enum.Font.Gotham
        CheckLabel.TextXAlignment = Enum.TextXAlignment.Left
        CheckLabel.Parent = Checkbox
        
        local checked = default or false
        
        local function UpdateCheck()
            if checked then
                CheckButton.BackgroundColor3 = Color3.fromRGB(80, 80, 255)
            else
                CheckButton.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
            end
        end
        
        UpdateCheck()
        
        CheckButton.MouseButton1Click:Connect(function()
            checked = not checked
            UpdateCheck()
            if callback then callback(checked) end
        end)
        
        return Checkbox
    end
    
    function Tab:AddSlider(text, min, max, default, callback)
        local Slider = Instance.new("Frame")
        Slider.Name = "Slider"
        Slider.Size = UDim2.new(1, 0, 0, 45)
        Slider.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
        Slider.BorderSizePixel = 0
        Slider.Parent = TabContent
        
        local SliderCorner = Instance.new("UICorner")
        SliderCorner.CornerRadius = UDim.new(0, 6)
        SliderCorner.Parent = Slider
        
        local SliderLabel = Instance.new("TextLabel")
        SliderLabel.Size = UDim2.new(0.7, 0, 0, 20)
        SliderLabel.Position = UDim2.new(0, 10, 0, 5)
        SliderLabel.BackgroundTransparency = 1
        SliderLabel.Text = text
        SliderLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        SliderLabel.TextSize = 13
        SliderLabel.Font = Enum.Font.Gotham
        SliderLabel.TextXAlignment = Enum.TextXAlignment.Left
        SliderLabel.Parent = Slider
        
        local ValueLabel = Instance.new("TextLabel")
        ValueLabel.Size = UDim2.new(0.3, -10, 0, 20)
        ValueLabel.Position = UDim2.new(0.7, 0, 0, 5)
        ValueLabel.BackgroundTransparency = 1
        ValueLabel.Text = tostring(default)
        ValueLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
        ValueLabel.TextSize = 12
        ValueLabel.Font = Enum.Font.Gotham
        ValueLabel.TextXAlignment = Enum.TextXAlignment.Right
        ValueLabel.Parent = Slider
        
        local SliderBar = Instance.new("Frame")
        SliderBar.Size = UDim2.new(1, -20, 0, 4)
        SliderBar.Position = UDim2.new(0, 10, 1, -12)
        SliderBar.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
        SliderBar.BorderSizePixel = 0
        SliderBar.Parent = Slider
        
        local BarCorner = Instance.new("UICorner")
        BarCorner.CornerRadius = UDim.new(1, 0)
        BarCorner.Parent = SliderBar
        
        local SliderFill = Instance.new("Frame")
        SliderFill.Size = UDim2.new(0, 0, 1, 0)
        SliderFill.BackgroundColor3 = Color3.fromRGB(80, 80, 255)
        SliderFill.BorderSizePixel = 0
        SliderFill.Parent = SliderBar
        
        local FillCorner = Instance.new("UICorner")
        FillCorner.CornerRadius = UDim.new(1, 0)
        FillCorner.Parent = SliderFill
        
        local dragging = false
        local value = default or min
        
        local function UpdateSlider(input)
            local pos = math.clamp((input.Position.X - SliderBar.AbsolutePosition.X) / SliderBar.AbsoluteSize.X, 0, 1)
            value = math.floor(min + (max - min) * pos)
            ValueLabel.Text = tostring(value)
            SliderFill.Size = UDim2.new(pos, 0, 1, 0)
            if callback then callback(value) end
        end
        
        SliderBar.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = true
                UpdateSlider(input)
            end
        end)
        
        SliderBar.InputEnded:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = false
            end
        end)
        
        UserInputService.InputChanged:Connect(function(input)
            if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
                UpdateSlider(input)
            end
        end)
        
        local initialPos = (default - min) / (max - min)
        SliderFill.Size = UDim2.new(initialPos, 0, 1, 0)
        
        return Slider
    end
    
    function Tab:AddDropdown(text, options, callback)
        local Dropdown = Instance.new("Frame")
        Dropdown.Name = "Dropdown"
        Dropdown.Size = UDim2.new(1, 0, 0, 35)
        Dropdown.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
        Dropdown.BorderSizePixel = 0
        Dropdown.ClipsDescendants = false
        Dropdown.Parent = TabContent
        
        local DropCorner = Instance.new("UICorner")
        DropCorner.CornerRadius = UDim.new(0, 6)
        DropCorner.Parent = Dropdown
        
        local DropButton = Instance.new("TextButton")
        DropButton.Size = UDim2.new(1, 0, 0, 35)
        DropButton.BackgroundTransparency = 1
        DropButton.Text = ""
        DropButton.Parent = Dropdown
        
        local DropLabel = Instance.new("TextLabel")
        DropLabel.Size = UDim2.new(1, -30, 1, 0)
        DropLabel.Position = UDim2.new(0, 10, 0, 0)
        DropLabel.BackgroundTransparency = 1
        DropLabel.Text = text .. ": None"
        DropLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        DropLabel.TextSize = 13
        DropLabel.Font = Enum.Font.Gotham
        DropLabel.TextXAlignment = Enum.TextXAlignment.Left
        DropLabel.Parent = Dropdown
        
        local Arrow = Instance.new("TextLabel")
        Arrow.Size = UDim2.new(0, 20, 1, 0)
        Arrow.Position = UDim2.new(1, -25, 0, 0)
        Arrow.BackgroundTransparency = 1
        Arrow.Text = "‚ñº"
        Arrow.TextColor3 = Color3.fromRGB(200, 200, 200)
        Arrow.TextSize = 10
        Arrow.Font = Enum.Font.Gotham
        Arrow.Parent = Dropdown
        
        local OptionList = Instance.new("Frame")
        OptionList.Name = "OptionList"
        OptionList.Size = UDim2.new(1, 0, 0, 0)
        OptionList.Position = UDim2.new(0, 0, 0, 40)
        OptionList.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
        OptionList.BorderSizePixel = 0
        OptionList.Visible = false
        OptionList.ClipsDescendants = true
        OptionList.ZIndex = 10
        OptionList.Parent = Dropdown
        
        local ListCorner = Instance.new("UICorner")
        ListCorner.CornerRadius = UDim.new(0, 6)
        ListCorner.Parent = OptionList
        
        local ListLayout = Instance.new("UIListLayout")
        ListLayout.Padding = UDim.new(0, 2)
        ListLayout.Parent = OptionList
        
        local open = false
        
        DropButton.MouseButton1Click:Connect(function()
            open = not open
            OptionList.Visible = open
            if open then
                OptionList:TweenSize(UDim2.new(1, 0, 0, math.min(#options * 32, 150)), Enum.EasingDirection.Out, Enum.EasingStyle.Quad, 0.2, true)
                Arrow.Text = "‚ñ≤"
            else
                OptionList:TweenSize(UDim2.new(1, 0, 0, 0), Enum.EasingDirection.Out, Enum.EasingStyle.Quad, 0.2, true, function()
                    OptionList.Visible = false
                end)
                Arrow.Text = "‚ñº"
            end
        end)
        
        for _, option in ipairs(options) do
            local OptionButton = Instance.new("TextButton")
            OptionButton.Size = UDim2.new(1, 0, 0, 30)
            OptionButton.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
            OptionButton.Text = option
            OptionButton.TextColor3 = Color3.fromRGB(255, 255, 255)
            OptionButton.TextSize = 12
            OptionButton.Font = Enum.Font.Gotham
            OptionButton.Parent = OptionList
            
            local OptCorner = Instance.new("UICorner")
            OptCorner.CornerRadius = UDim.new(0, 4)
            OptCorner.Parent = OptionButton
            
            OptionButton.MouseButton1Click:Connect(function()
                DropLabel.Text = text .. ": " .. option
                open = false
                OptionList:TweenSize(UDim2.new(1, 0, 0, 0), Enum.EasingDirection.Out, Enum.EasingStyle.Quad, 0.2, true, function()
                    OptionList.Visible = false
                end)
                Arrow.Text = "‚ñº"
                if callback then callback(option) end
            end)
        end
        
        return Dropdown
    end
    
    function Tab:AddButton(text, callback)
        local Button = Instance.new("TextButton")
        Button.Name = "Button"
        Button.Size = UDim2.new(1, 0, 0, 35)
        Button.BackgroundColor3 = Color3.fromRGB(80, 80, 255)
        Button.Text = text
        Button.TextColor3 = Color3.fromRGB(255, 255, 255)
        Button.TextSize = 14
        Button.Font = Enum.Font.GothamBold
        Button.Parent = TabContent
        
        local BtnCorner = Instance.new("UICorner")
        BtnCorner.CornerRadius = UDim.new(0, 6)
        BtnCorner.Parent = Button
        
        Button.MouseButton1Click:Connect(function()
            if callback then callback() end
        end)
        
        return Button
    end
    
    table.insert(self.Tabs, Tab)
    
    if #self.Tabs == 1 then
        TabButton.BackgroundColor3 = Color3.fromRGB(70, 70, 200)
        TabIcon.ImageColor3 = Color3.fromRGB(255, 255, 255)
        TabLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        TabContent.Visible = true
        self.CurrentTab = Tab
    end
    
    return Tab
end

return Library
