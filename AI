LibraryV2 = {}
LibraryV2.__index = LibraryV2
LibraryV2.Notifications = {}

--[[ // Plan 

    Program config checker
    See if user has ever used the script before, else prompt first time UI
    
    LIB SYSTEM - {

        Tab creation - {

            Tab (instance)
            Name (string)
            Containers (table)

        }

        Container creation - {

            Container (instance)
            Name (string)
            Tab (table)
            Assets (table)
            
        }

        Asset creation - {

            Asset (instance)
            Name (string)
            Container (table)

            Get (func) - {
                arguments:
                    [1] = string (can get a certain piece of data about the asset if it's available eg. Toggle_State)
            }

        }

        Show (global func)
        Hide (global func) - Alliases {
            arguments:
                [1] = bool (hide all in same tab)
        }.
        Update (global func)
    }

--]]

--// Services
local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")

-- Shortened funcs
local u2 = UDim2.new
local v3 = Vector3.new
local pi = math.pi
local hf = hookfunction

-- Needed assets

-- Outer blur
local Blur = Instance.new("BlurEffect")
Blur.Name = "Xenon_Blur"
Blur.Size = 0
Blur.Parent = game:GetService("Lighting")


-- Useful funcs

function TandemTween(tbl, according, totaltime)
	
	local time_per = (totaltime/#tbl)
	
	for i = 1, #tbl do
		
		Tween(according[i], {Position = tbl[i]}, time_per)
		task.wait(time_per)
		
	end
	
end

function Tween(inst, tType, t, yield, pref)
    local Tween = TweenService:Create(inst, TweenInfo.new(pref and pref or t and t or 1), tType)
    Tween:Play()

    if yield then
        Tween.Completed:Wait()
    end
end

function RoundNumber(num, numDecimalPlaces)
    return tonumber(string.format("%." .. (numDecimalPlaces or 0) .. "f", num))
end

function Ripple(asset, x, y)
    assert(x and y, "Please provide x and y coordinates!")

    coroutine.resume(coroutine.create(function()
         local New_Ripple = GetAsset("RippleAsset"):Clone()
         New_Ripple.Parent = asset
         New_Ripple.ImageTransparency = 0.6
         New_Ripple.Position = u2(0, (x-asset.AbsolutePosition.X), 0, (y-asset.AbsolutePosition.Y-36))
		 New_Ripple.Size = u2(0, 0, 0, 0)

         local Length, Size = 0.6, (asset.AbsoluteSize.X >= asset.AbsoluteSize.Y and asset.AbsoluteSize.X * 1.5 or button.AbsoluteSize.Y * 1.5)
         local Tween = game:GetService("TweenService"):Create(New_Ripple, TweenInfo.new(Length, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            Size = u2(0, Size, 0, Size),
            Position = u2(0.5, (-Size / 2), 0.5, (-Size / 2)),
            ImageTransparency = 1
         })
         Tween:Play()
         Tween.Completed:Wait()
         New_Ripple:Destroy()
    end))
end

function WaitUntil(wait_for)
    repeat task.wait() until wait_for
end

function GetAsset(Asset)
    for i,v in pairs(game.CoreGui:FindFirstChild("TUI2"):GetDescendants()) do
    	if v.Name == Asset then
			return v
		end
    end
end

function LibraryV2.UI(Name)

    if game.CoreGui:FindFirstChild("TUI2") then
        game.CoreGui.TUI2:Destroy();
        game:GetService("Lighting"):FindFirstChild("Xenon_Blur"):Destroy();
    end

    local Library
    Library = {
        _UI = game:GetObjects("rbxassetid://8388979705")[1],
        Name = Name or "Untitled",
        Tabs = {},
        State = false,
        ToggleKey = Enum.KeyCode.LeftControl,
        Debounce = false,

        Show_UI = function()
            local P = Library._UI.Lib.Position
            Tween(Library._UI.Lib, {Position = u2(0.75, P.X.Offset, P.Y.Size, P.Y.Offset)})
        end,
        
        Hide_UI = function()
            local P = Library.UI.Lib.Position
            Tween(Library._UI.Lib, {Position = u2(1, P.X.Offset, P.Y.Size, P.Y.Offset)})
        end,

        Hide_All = function()
            for i,v in pairs(Library._UI.Lib.Holder:GetChildren()) do
                if v.ClassName ~= "UIListLayout" and v.ClassName ~= "Folder" then
                    v.Visible = false
                end
            end
        end,

        Show = function(show_tbl)
            for i,v in pairs(show_tbl) do
                v.Visible = true             
            end
        end,

        Hide = function(hide_tbl)
            for i,v in pairs(hide_tbl) do
                v.Visible = false                
            end
        end,

        Startup = function()
            local TUI = Library._UI
            local Widgets = TUI.Widgets
            
            -- Ð¡Ð¾Ð±Ð¸Ñ€Ð°ÐµÐ¼ Ð²Ð¸Ð´Ð¶ÐµÑ‚Ñ‹, Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÑ Ð¸Ñ… ÑÑƒÑ‰ÐµÑÑ‚Ð²Ð¾Ð²Ð°Ð½Ð¸Ðµ
            local Widget1 = Widgets:FindFirstChild("Bookmarks")
            local Widget2 = Widgets:FindFirstChild("Widget") -- Changelog
            local Widget3 = Widgets:FindFirstChild("Discord")
            local Widget4 = Widgets:FindFirstChild("Unload") or Widgets:FindFirstChild("Music")
            
            local Tabs = TUI.TabContainer
            local BottomMenu = TUI.BottomMenu
            local TopMenu = TUI.Top
            local Time = TUI.Time
            local TimeLabel = TUI.TimeLabel
            
            local TabsPos = Tabs.Position
            local BMPos = BottomMenu.Position
            local TPos = TopMenu.Position
            local TimePos = Time.Position
            local TLPos = TimeLabel.Position
            local Transparency_Back = TUI.Darkener.BackgroundTransparency
            
            local WidgetsList = {}
            local WidgetPosList = {}
            
            -- Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ðµ Ð²Ð¸Ð´Ð¶ÐµÑ‚Ñ‹
            if Widget1 then 
                table.insert(WidgetsList, Widget1)
                table.insert(WidgetPosList, Widget1.Position)
            end
            if Widget2 then 
                table.insert(WidgetsList, Widget2)
                table.insert(WidgetPosList, Widget2.Position)
            end
            if Widget3 then 
                table.insert(WidgetsList, Widget3)
                table.insert(WidgetPosList, Widget3.Position)
            end
            if Widget4 then 
                table.insert(WidgetsList, Widget4)
                table.insert(WidgetPosList, Widget4.Position)
            end
            
            for i,v in pairs(WidgetsList) do
                v.Position = UDim2.new(v.Position.X.Scale, v.Position.X.Offset, 1, v.Position.Y.Offset)
            end
            Tabs.Position = UDim2.new(-0.05, Tabs.Position.X.Offset, Tabs.Position.Y.Scale, Tabs.Position.Y.Offset)
            BottomMenu.Position = UDim2.new(BottomMenu.Position.X.Scale, BottomMenu.Position.X.Offset, 1, BottomMenu.Position.Y.Offset)
            TopMenu.Position = UDim2.new(TopMenu.Position.X.Scale, TopMenu.Position.X.Offset, -0.15, TopMenu.Position.Y.Offset)
            Time.TextTransparency = 1
            TimeLabel.TextTransparency = 1
            TUI.Darkener.BackgroundTransparency = 1
            
            for i,v in pairs(Library._UI:GetChildren()) do
                if v.ClassName ~= "Folder" and v.Name ~= "Darkener" then
                    v.Visible = true
                end
            end

            for i,v in pairs(Library._UI.Widgets:GetChildren()) do
                if v.Name ~= "Music" then -- ÐÐµ Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°Ñ‚ÑŒ Ð¼ÑƒÐ·Ñ‹ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð²Ð¸Ð´Ð¶ÐµÑ‚
                    v.Visible = true
                end
            end
            
            game:GetService("StarterGui"):SetCoreGuiEnabled(Enum.CoreGuiType.All, false)

            --// Animate
            Tween(TUI.Darkener, {BackgroundTransparency = Transparency_Back}, 0.5, true)
            if #WidgetPosList > 0 then
                TandemTween(WidgetPosList, WidgetsList, 0.5)
            end
            Tween(BottomMenu, {Position = BMPos}, 0.25)
            Tween(Tabs, {Position = TabsPos}, 0.25)
            Tween(TopMenu, {Position = TPos}, 0.25, true)
            
            -- ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ changelog Ð¿Ñ€Ð¸ Ð¿ÐµÑ€Ð²Ð¾Ð¼ Ð·Ð°Ð¿ÑƒÑÐºÐµ
            task.delay(1, function()
                LibraryV2:Notification("ðŸ“‹ Welcome!", "Click on Changelog widget to see what's new!", "6031280882", 5)
            end)
        end,

        Update = function()
            if Library.Debounce then return end

            if Library.State == true then
                Library.Debounce = true
                Tween(Blur, {Size = 24}, 0.5)
                Library._UI.Enabled = true
                Library.Startup()
                Library.Debounce = false    
            else
                Library.Debounce = true
                Library._UI.Enabled = false
                Tween(Blur, {Size = 0}, 0.5, true)
                Library.Debounce = false
                game:GetService("StarterGui"):SetCoreGuiEnabled(Enum.CoreGuiType.All, true)
            end
        end
    }
    Library._UI.Parent = game.CoreGui
    Library._UI.Enabled = false
    Library._UI:FindFirstChild("Name").Text = Library.Name
    Library._UI.IgnoreGuiInset = true

    Library._UI.Lib.Exit.MouseButton1Down:Connect(function()
        Tween(Library._UI.Lib, {Position = u2(1, 0, Library._UI.Lib.Position.Y.Scale, 0)}, 0.5) 
    end)

    --// Top Menu
    local TopMenu = Library._UI.Top

    local ELib_Data
    local _Data = pcall(function()
        ELib_Data = game:GetService("HttpService"):JSONDecode(readfile("cf.elib"))
    end)

    function SaveData()
        writefile(ELib_Data.Config_Name, game:GetService("HttpService"):JSONEncode(ELib_Data))
    end

    if not _Data then
        ELib_Data = {
            Last_Visit = os.date("%x", os.time()),
            Config_Name = "cf_l.elib",
        }

        SaveData()
    end

    TopMenu.last.Text = "last visit: "..ELib_Data.Last_Visit
    TopMenu.cf.Text = "cf name: "..ELib_Data.Config_Name
    TopMenu.holder.TextLabel.Text = "welcome, "..game:GetService("Players").LocalPlayer.Name

    ELib_Data.Last_Visit = os.date("%x", os.time())
    SaveData()

    --// Discord Widget
    local Widgets = Library._UI.Widgets
    
    -- Ð¡ÐºÑ€Ñ‹Ñ‚ÑŒ Ð¼ÑƒÐ·Ñ‹ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð²Ð¸Ð´Ð¶ÐµÑ‚ ÐµÑÐ»Ð¸ Ð¾Ð½ ÐµÑÑ‚ÑŒ
    if Widgets:FindFirstChild("Music") then
        Widgets.Music.Visible = false
    end
    
    --// Changelog Widget (Ð·Ð°Ð¼ÐµÐ½ÑÐµÐ¼ "add widget")
    if Widgets:FindFirstChild("Widget") then
        local ChangelogWidget = Widgets.Widget
        
        -- Ð˜Ð·Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ñ‚ÐµÐºÑÑ‚
        if ChangelogWidget:FindFirstChild("Under") then
            ChangelogWidget.Under.Text = "changelog"
        end
        
        -- ÐÐ°Ð¹Ñ‚Ð¸ Ð¸Ð»Ð¸ ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ TextButton Ð´Ð»Ñ changelog
        local changelogButton = ChangelogWidget:FindFirstChild("TextButton")
        
        if changelogButton and changelogButton:IsA("TextButton") then
            -- Ð•ÑÐ»Ð¸ TextButton ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ ÐµÐ³Ð¾
            changelogButton.Text = "VIEW"
            changelogButton.MouseButton1Click:Connect(function()
                LibraryV2:Notification("ðŸ“‹ Changelog v1.0", "âœ… Removed music system\nâœ… Added Unload button\nâœ… Fixed container sizes (340px)\nâœ… Containers now clickable\nâœ… Improved UI stability", "6031280882", 10)
            end)
        else
            -- Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð½Ð¾Ð²Ñ‹Ð¹ TextButton
            local ChangelogButton = Instance.new("TextButton")
            ChangelogButton.Name = "ChangelogButton"
            ChangelogButton.Size = UDim2.new(0.8, 0, 0.3, 0)
            ChangelogButton.Position = UDim2.new(0.1, 0, 0.6, 0)
            ChangelogButton.BackgroundColor3 = Color3.fromRGB(100, 150, 255)
            ChangelogButton.Text = "VIEW CHANGELOG"
            ChangelogButton.TextColor3 = Color3.fromRGB(255, 255, 255)
            ChangelogButton.Font = Enum.Font.GothamBold
            ChangelogButton.TextSize = 12
            ChangelogButton.BorderSizePixel = 0
            ChangelogButton.Parent = ChangelogWidget
            
            ChangelogButton.MouseButton1Click:Connect(function()
                LibraryV2:Notification("ðŸ“‹ Changelog v1.0", "âœ… Removed music system\nâœ… Added Unload button\nâœ… Fixed container sizes (340px)\nâœ… Containers now clickable\nâœ… Improved UI stability", "6031280882", 10)
            end)
        end
    end
    
    Widgets.Discord.TextButton.MouseButton1Click:Connect(function()
        setclipboard("Xenon Server: https://discord.gg/DXrGhrxZ9v")
    end)
    
    --// Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Unload ÐºÐ½Ð¾Ð¿ÐºÑƒ Ð¸Ð· Ð¼ÑƒÐ·Ñ‹ÐºÐ°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð²Ð¸Ð´Ð¶ÐµÑ‚Ð°
    if Widgets:FindFirstChild("Music") then
        local UnloadWidget = Widgets.Music:Clone()
        UnloadWidget.Name = "Unload"
        UnloadWidget.Parent = Widgets
        UnloadWidget.Visible = true
        
        -- Ð˜Ð·Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ñ‚ÐµÐºÑÑ‚ Ð¸ Ð¸ÐºÐ¾Ð½ÐºÑƒ
        if UnloadWidget:FindFirstChild("Under") then
            UnloadWidget.Under.Text = "unload ui"
        end
        
        -- Ð¡ÐºÑ€Ñ‹Ñ‚ÑŒ ÐºÐ½Ð¾Ð¿ÐºÐ¸ Spotify/Soundcloud
        if UnloadWidget:FindFirstChild("Spotify") then
            UnloadWidget.Spotify.Visible = false
        end
        if UnloadWidget:FindFirstChild("Soundcloud") then
            UnloadWidget.Soundcloud.Visible = false
        end
        
        -- Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ ÐºÐ½Ð¾Ð¿ÐºÑƒ Unload
        if UnloadWidget:FindFirstChild("TextButton") then
            UnloadWidget.TextButton.Text = "UNLOAD"
            UnloadWidget.TextButton.MouseButton1Click:Connect(function()
                -- ÐÐ½Ð¸Ð¼Ð°Ñ†Ð¸Ñ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ñ
                Library.State = false
                Library._UI.Enabled = false
                Tween(Blur, {Size = 0}, 0.5, true)
                
                -- Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ CoreGui
                game:GetService("StarterGui"):SetCoreGuiEnabled(Enum.CoreGuiType.All, true)
                
                -- Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ UI
                task.wait(0.5)
                if game.CoreGui:FindFirstChild("TUI2") then
                    game.CoreGui.TUI2:Destroy()
                end
                if game:GetService("Lighting"):FindFirstChild("Xenon_Blur") then
                    game:GetService("Lighting").Xenon_Blur:Destroy()
                end
                
                -- Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ
                pcall(function()
                    game:GetService("StarterGui"):SetCore("SendNotification", {
                        Title = "UI Unloaded",
                        Text = "LibraryV2 has been unloaded successfully!",
                        Duration = 3
                    })
                end)
            end)
        else
            -- Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð½Ð¾Ð²ÑƒÑŽ ÐºÐ½Ð¾Ð¿ÐºÑƒ ÐµÑÐ»Ð¸ TextButton Ð½Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚
            local UnloadButton = Instance.new("TextButton")
            UnloadButton.Name = "UnloadButton"
            UnloadButton.Size = UDim2.new(0.8, 0, 0.3, 0)
            UnloadButton.Position = UDim2.new(0.1, 0, 0.6, 0)
            UnloadButton.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
            UnloadButton.Text = "UNLOAD UI"
            UnloadButton.TextColor3 = Color3.fromRGB(255, 255, 255)
            UnloadButton.Font = Enum.Font.GothamBold
            UnloadButton.TextSize = 14
            UnloadButton.Parent = UnloadWidget
            
            UnloadButton.MouseButton1Click:Connect(function()
                -- ÐÐ½Ð¸Ð¼Ð°Ñ†Ð¸Ñ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ñ
                Library.State = false
                Library._UI.Enabled = false
                Tween(Blur, {Size = 0}, 0.5, true)
                
                -- Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ CoreGui
                game:GetService("StarterGui"):SetCoreGuiEnabled(Enum.CoreGuiType.All, true)
                
                -- Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ UI
                task.wait(0.5)
                if game.CoreGui:FindFirstChild("TUI2") then
                    game.CoreGui.TUI2:Destroy()
                end
                if game:GetService("Lighting"):FindFirstChild("Xenon_Blur") then
                    game:GetService("Lighting").Xenon_Blur:Destroy()
                end
                
                -- Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ
                pcall(function()
                    game:GetService("StarterGui"):SetCore("SendNotification", {
                        Title = "UI Unloaded",
                        Text = "LibraryV2 has been unloaded successfully!",
                        Duration = 3
                    })
                end)
            end)
        end
    end

    game:GetService("UserInputService").InputBegan:Connect(function(Key, IsTyping)
        if IsTyping then
            return
        end

        if Key.KeyCode == Library.ToggleKey then
            Library.State = not Library.State
            Library.Update()
        end
    end)

    return setmetatable(Library, LibraryV2)
end

function LibraryV2:Tab(Name, Icon)
    local Tab
    Tab = {
        Name = Name,
        Icon = "rbxassetid://"..Icon,
        Containers = {},
        Tweens = {},

        Tab = GetAsset("TabTemplate"):Clone(),

        CancelTweens = function()
            for i, tween in pairs(Tab.Tweens) do
                tween:Cancel()
                table.remove(Tab.Tweens, i)
            end
        end,

        Update = function(...)
            Tab.Tab.Icon.Image = Tab.Icon
            Tab.Tab.Effect.TL.Label.Text = Tab.Name
            
            local _m = #self.Tabs-1
            self._UI.TabContainer.Size = u2(0, 71, 0, (80)+(55*_m + (5*(_m+1))))
        end,

        _UI = self._UI
    }
	table.insert(self.Tabs, Tab)
    
    Tab.Tab.Parent = self._UI.TabContainer.Holder
    Tab.Update()

    Tab.Tab.MouseEnter:Connect(function()
        Tab.CancelTweens() --To prevent bugging out

        local TextTween = Tab.Tab.Effect.TL
        local Tween = game:GetService("TweenService"):Create(TextTween, TweenInfo.new(0.2), {Position = u2(0.5, 0, 0.5, 0)})
        Tween:Play()

        table.insert(Tab.Tweens, Tween)
    end)

    Tab.Tab.MouseLeave:Connect(function()
        Tab.CancelTweens() --To prevent bugging out

        local TextTween = Tab.Tab.Effect.TL
        local Tween = game:GetService("TweenService"):Create(TextTween, TweenInfo.new(0.2), {Position = u2(1.5, 0, 0.5, 0)})
        Tween:Play()

        table.insert(Tab.Tweens, Tween)
    end)

    Tab.Tab.MouseButton1Down:Connect(function()
        Tween(self._UI.Lib, {Position = u2(0.75, 0, self._UI.Lib.Position.Y.Scale, 0)}, 0.5)
        self.Hide_All()
        self.Show(Tab.Containers)
    end)
    
    self._UI.Lib.Holder.UIListLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        self._UI.Lib.Holder.CanvasSize = UDim2.new(0,0,0,self._UI.Lib.Holder.UIListLayout.AbsoluteContentSize.Y)
    end)

    return setmetatable(Tab, LibraryV2)
end

function LibraryV2:Container(Name)
    local Container
    Container = {
        Name = Name,
        Assets = {},
        Drops = {},
        Tweens = {},
        State = false,

        Container = GetAsset("Container"):Clone(),

        CancelTweens = function()
            for i, tween in pairs(Container.Tweens) do
                tween:Cancel()
                table.remove(Container.Tweens, i)
            end
        end,

        Update = function(...)
            Container.Container.TextLabel.Text = Container.Name
        end,

        In = function()
            --// Tween the container in (collapse)
            Container.CancelTweens()
            Tween(Container.Container.ImageLabel, {Rotation = 0}, 0.3)
            local Tween = game:GetService("TweenService"):Create(Container.Container, TweenInfo.new(0.3), {Size = u2(0, 340, 0, 50)})
            Tween:Play()
            
            -- Hide all assets
            for i,v in pairs(Container.Assets) do
                v.Visible = false
            end
    
            Tween.Completed:Wait()
            table.insert(Container.Tweens, Tween)
        end,

        Out = function()
            --// Tween the container out (expand)
            Container.CancelTweens()
            Tween(Container.Container.ImageLabel, {Rotation = 180}, 0.3)
            
            -- Show all assets
            for i,v in pairs(Container.Assets) do
                v.Visible = true
            end
            
            local Tween = game:GetService("TweenService"):Create(Container.Container, TweenInfo.new(0.3), {Size = u2(0, 340, 0, ((65)+55*#Container.Assets))})
            Tween:Play()
    
            table.insert(Container.Tweens, Tween)
        end
    }
    table.insert(self.Containers, Container.Container)

    Container.Container.Parent = self._UI.Lib.Holder
    Container.Update()
    
    -- Start with container collapsed (elements hidden)
    Container.Container.Size = u2(0, 340, 0, 50)
    Container.Container.ImageLabel.Rotation = 0

    Container.Container.ImageLabel.MouseButton1Down:Connect(function()
        if Container.State then
            Container.In()

            for i,v in pairs(Container.Drops) do
                if v.State == false then
                    Tween(v.Asset, {Size = u2(0, 407 , 0, 50)}, 0.01)
                    Tween(v.Asset.Image, {Rotation = 0}, 0.01)
                end
            end
        else
            Container.Out()
        end

        Container.State = not Container.State
    end)

    return setmetatable(Container, LibraryV2)
end

function LibraryV2:Button(Name, Callback)
    local Button
    Button = {
        Name = Name,
        Callback = Callback or function() end,
        Class = "Button",

        Asset = GetAsset("Button"):Clone(),

        Update = function(...)
            Button.Asset.Text = "  "..Button.Name
        end
    }
    table.insert(self.Assets, Button.Asset)

    Button.Asset.Visible = false  -- Start hidden
    Button.Asset.Parent = self.Container.ScrollingFrame
    Button.Update()

    Button.Asset.MouseButton1Down:Connect(function(X, Y)
        pcall(Button.Callback)
        Ripple(Button.Asset, X, Y)
    end)

    return setmetatable(Button, LibraryV2)
end

function LibraryV2:Toggle(Name, StartingState, Callback, RunOnStart)
    local Toggle
    Toggle = {
        Name = Name,
        State = StartingState,
        Callback = Callback or function() end,
        Class = "Toggle",

        Asset = GetAsset("Toggle"):Clone(),

        Update = function(...)
            Toggle.Asset.Text = "  "..Toggle.Name
            Toggle.Asset.ImageLabel.Image = (Toggle.State and "rbxassetid://6031068426" or "rbxassetid://6031068433")
        end
    }
    table.insert(self.Assets, Toggle.Asset)

    Toggle.Asset.Visible = false  -- Start hidden
    Toggle.Asset.Parent = self.Container.ScrollingFrame
    Toggle.Update()

    Toggle.Asset.MouseButton1Down:Connect(function(X, Y)
        Toggle.State = not Toggle.State
        Toggle.Update()

        pcall(Toggle.Callback, Toggle.State)
        Ripple(Toggle.Asset, X, Y)
    end)

    if Toggle.State == true and RunOnStart then
        pcall(Toggle.Callback, Toggle.State)
    end
    
    return setmetatable(Toggle, LibraryV2)
end

function LibraryV2:Dropdown(Name, List, Callback)
    local Dropdown
    Dropdown = {
        
        Name = Name,
        List = List,
        Callback = Callback or function() end,
        State = false,
        Debounce = false,
        Class = "Dropdown",

        Asset = GetAsset("Dropdown"):Clone(),

        Other = {
            ExtensionSize = nil
        },

        Update = function(...)
            Dropdown.Asset.NameLabel.Text = "  "..Dropdown.Name
            Dropdown.Other.ExtensionSize = ((70) + (45*#Dropdown.List) + (5*#Dropdown.List))

            if #Dropdown.List > 6 then
                Dropdown.Other.ExtensionSize = 375;
            end

            for _, v in pairs(Dropdown.Asset.DropContainer:GetChildren()) do
                if v:IsA("TextButton") then
                    v:Destroy()
                end
            end --// Clear the dropdown

            --// Refresh with New ones
            local Template = GetAsset("DropdownTemplate")
            for i,v in pairs(Dropdown.List) do
                local New_Template = Template:Clone()
                New_Template.Parent = Dropdown.Asset.DropContainer
                New_Template.Visible = true
                New_Template.Text = "   " .. v
                New_Template.Name = v

                New_Template.MouseButton1Down:Connect(function()
                    if Dropdown.State == false then
                        pcall(Dropdown.Callback, v)
                        Dropdown.Debounce = true
                        State = not State
                        Tween(Dropdown.Asset, {Size = u2(0, 407 , 0, 50)}, 0.35)
                        Tween(Dropdown.Asset.Image, {Rotation = 0}, 0.35)
                        Tween(self.Container, {Size = u2(self.Container.Size.X.Scale, self.Container.Size.X.Offset, self.Container.Size.Y.Scale, (self.Container.Size.Y.Offset - (Dropdown.Other.ExtensionSize-50)))}, 0.35)
                        
                        task.wait(0.5)
                        Dropdown.Debounce = false
                    end
                end)

            end

            if #Dropdown.List > 6 then
                local Content = Dropdown.Asset.DropContainer.UIListLayout.AbsoluteContentSize
                Dropdown.Asset.DropContainer.CanvasSize = UDim2.new(0, 0, 0, Content.Y + 69);
            else
                Dropdown.Asset.DropContainer.CanvasSize = UDim2.new(0, 0, 0, 0);
            end

        end
    }
    table.insert(self.Assets, Dropdown.Asset)
    table.insert(self.Drops, Dropdown)

    Dropdown.Asset.Visible = false  -- Start hidden
    Dropdown.Asset.Parent = self.Container.ScrollingFrame
    Dropdown.Update()

    Dropdown.Asset.MouseButton1Down:Connect(function(X, Y)
        if Dropdown.Debounce then return end
		Ripple(Dropdown.Asset, X, Y)

        if State and Dropdown.Asset.Size.Y.Offset == 50 then
            State = not State
        end

        if State then
            Dropdown.Debounce = true
            State = not State
            Tween(Dropdown.Asset, {Size = u2(0, 407, 0, 50)}, 0.35)
            Tween(Dropdown.Asset.Image, {Rotation = 0}, 0.35)
            Tween(self.Container, {Size = u2(self.Container.Size.X.Scale, self.Container.Size.X.Offset, self.Container.Size.Y.Scale, (self.Container.Size.Y.Offset - (Dropdown.Other.ExtensionSize-50)))}, 0.35)
            task.wait(0.5)
            Dropdown.Debounce = false
        else
            Dropdown.Debounce = true
            State = not State
            Tween(Dropdown.Asset, {Size = u2(0, 407 , 0, Dropdown.Other.ExtensionSize)}, 0.35)
            Tween(Dropdown.Asset.Image, {Rotation = 180}, 0.35)
            Tween(self.Container, {Size = u2(self.Container.Size.X.Scale, self.Container.Size.X.Offset, self.Container.Size.Y.Scale, (self.Container.Size.Y.Offset + (Dropdown.Other.ExtensionSize-50)))}, 0.35)

            task.wait(0.5)
            Dropdown.Debounce = false
        end
    end)
    

    return setmetatable(Dropdown, LibraryV2)
end

function LibraryV2:Label(Text)
    local Label
    Label = {
        Text = Text,
        Class = "Label",

        Asset = GetAsset("LabelTemplate"):Clone(),

        Update = function(...)
            Label.Asset.Text = "  "..Label.Text
        end
    }
    table.insert(self.Assets, Label.Asset)  -- Fixed: should be Label.Asset, not Label

    Label.Asset.Visible = false  -- Start hidden
    Label.Asset.Parent = self.Container.ScrollingFrame
    Label.Update()

    return setmetatable(Label, LibraryV2)
end

function LibraryV2:Keybind(Name, Starting_Key, Blacklisted_Keys, Callback)
    local Keybind
    Keybind = {

        Name = Name,
        Key = Starting_Key or Enum.KeyCode.E,
        Blacklist = Blacklisted_Keys or {"W", "A", "S", "D"},
        Callback = Callback or function() end,
        Debounce = false,
        Class = "Keybind",

        Asset = GetAsset("Key"):Clone(),

        Connections = {In_Change = false},

        ValidKey = function(Key)
			return (typeof(Key) == "EnumItem")
		end,

		GetKeystringFromEnum = function(Key)
			Key = tostring(Key)

            if Key == "..." then
                return "..."
            end

			return ( string.sub( Key,  14, #Key ) )
		end,

		IsNotMouse = function(Key)
			return (Key.UserInputType == Enum.UserInputType.MouseButton1 or Key.UserInputType == Enum.UserInputType.MouseButton2)
		end,

        Update = function(...)
            Keybind.Asset.Text = "  "..Keybind.Name
            Keybind.Asset.Key_Back.Key_Label.Text = Keybind.GetKeystringFromEnum(Keybind.Key)
        end
    }
    table.insert(self.Assets, Keybind.Asset)

    Keybind.Asset.Visible = false  -- Start hidden
    Keybind.Asset.Parent = self.Container.ScrollingFrame
    Keybind.Update()

    Keybind.Connections.KeyPress = game:GetService("UserInputService").InputBegan:Connect(function(Input, GameProcessedEvent)
        if GameProcessedEvent then return end

        if Input.KeyCode == Keybind.Key and not Keybind.Connections.In_Change == true then
            pcall(Keybind.Callback)
        end
    end)

    Keybind.Asset.MouseButton1Down:Connect(function(X, Y)
        if not Keybind.Debounce then
            Keybind.Debounce = true
            Keybind.Connections.In_Change = true
            Ripple(Keybind.Asset, X, Y)

            local Continue = false
            local Cache = {}
            Cache.OldText = Keybind.Name
            Cache.OldKey = Keybind.Key

            Keybind.Name = Keybind.Name .. " [press enter to cancel]"
            Keybind.Key = "..."
            Keybind.Update()

            Keybind.Connections.Change_Connection = game:GetService("UserInputService").InputBegan:Connect(function(Input, GameProcessedEvent)
                if GameProcessedEvent then return end
                if Keybind.IsNotMouse(Input) then return end

                if Input.KeyCode == Enum.KeyCode.Return then
                    Continue = true
                    Keybind.Key = Cache.OldKey
                    Keybind.Connections.Change_Connection:Disconnect()

                    Keybind.Update()  
                end

                if not Continue and not table.find(Keybind.Blacklist, Keybind.GetKeystringFromEnum(Input.KeyCode)) then
                    Keybind.Key = Input.KeyCode
                    Keybind.Update()
                    Continue = true

                    pcall(Keybind.Callback, Keybind.GetKeystringFromEnum(Keybind.Key))
                    Keybind.Connections.Change_Connection:Disconnect()
                end
            end)
            repeat wait() until Continue
            Keybind.Name = Cache.OldText
            Keybind.Connections.In_Change = false
            Cache = nil

            Keybind.Update()
            wait(0.5)
            Keybind.Debounce = false
        end
    end)

    return setmetatable(Keybind, LibraryV2)
end

function LibraryV2:TextBox(Name, Callback)
    local TextBox
    TextBox = {

        Name = Name,
        Callback = Callback or function() end,
        CanCall = true,
        Class = "TextBox",

        Asset = GetAsset("Textbox"):Clone(),

        Update = function(...)
            TextBox.Asset.Text = "  "..TextBox.Name

			local Args = {...}
            if Args[1] then
                TextBox.Asset.Cover.BoxText.Text = Args[1]
                pcall(TextBox.Callback, Args[1])
            end
        end
    }
    table.insert(self.Assets, TextBox.Asset)

    TextBox.Asset.Visible = false  -- Start hidden
    TextBox.Asset.Parent = self.Container.ScrollingFrame
    TextBox.Update()

    TextBox.Asset.Cover.BoxText.Focused:Connect(function()
        if TextBox.CanCall then
            TextBox.Asset.Cover.BoxText:ReleaseFocus()
        end
    end)

    TextBox.Asset.MouseButton1Down:Connect(function(X, Y)
        if TextBox.CanCall then
            TextBox.CanCall = false
            Ripple(TextBox.Asset, X, Y)

            TextBox.Asset.Cover.BoxText:CaptureFocus()
            TextBox.Asset.Cover.BoxText.FocusLost:Wait()
            pcall(TextBox.Callback, TextBox.Asset.Cover.BoxText.Text)
				
            task.wait(0.2)
            TextBox.CanCall = true
        end
    end)

    return setmetatable(TextBox, LibraryV2)
end

function LibraryV2:Slider(Name, Min, Max, Start, Callback, Use_Decimals)
    local Slider
    Slider = {

        Name = Name,
        Min = Min or 0,
        Max = Max or 100,
        Value = Start or 0,
        Callback = Callback or function() end,
        Class = "Slider",

        Values = {
            Dragging = false,

        },

        Asset = GetAsset("Slider"):Clone(),

        Update = function(...)
            Slider.Asset:FindFirstChild("Name").Text = Slider.Name

            local New = Slider.Value
            Slider.Asset.Slider_Whole.Slider:TweenSize(UDim2.new((New - Slider.Min)/(Slider.Max - Slider.Min), 0, 1, 0), "Out", "Sine", 0.1, true)
			Slider.Asset.Percentage.Text = tostring(New)

            --[[
			if bool then
				pcall(Slider.Callback, New)
			end--]]
        end
    }
    table.insert(self.Assets, Slider.Asset)

    Slider.Asset.Name = Slider.Name
    Slider.Asset.Visible = false  -- Start hidden
    Slider.Asset.Parent = self.Container.ScrollingFrame
    Slider.Update()

    Slider.Asset.Slider_Whole.Slider.Circle.InputBegan:Connect(
        function(Input)
            if Input.UserInputType == Enum.UserInputType.MouseButton1 then
                Slider.Dragging = true
            end
        end
    )
    Slider.Asset.Slider_Whole.Slider.Circle.InputEnded:Connect(
        function(Input)
            if Input.UserInputType == Enum.UserInputType.MouseButton1 then
                Slider.Dragging = false
            end
        end
    )

    game:GetService("UserInputService").InputChanged:Connect(
    function(Input)
        if Slider.Dragging and Input.UserInputType == Enum.UserInputType.MouseMovement then
            local Bound = Slider.Asset.Slider_Whole.AbsoluteSize.X
            local Pos1 =
                UDim2.new(
                    math.clamp((Input.Position.X - Slider.Asset.Slider_Whole.Slider.AbsolutePosition.X) / Bound, 0, 1),
                    0,
                    1,
                    0
                )
            Slider.Asset.Slider_Whole.Slider:TweenSize(Pos1, "Out", "Sine", 0.1, true)
            Slider.Value = (Use_Decimals and RoundNumber((((Pos1.X.Scale * Slider.Max) / Slider.Max) * (Slider.Max - Slider.Min) + Slider.Min), 1) or math.floor((((Pos1.X.Scale * Slider.Max) / Slider.Max) * (Slider.Max - Slider.Min) + Slider.Min)))
            Slider.Asset.Percentage.Text = tostring(Slider.Value)
            pcall(Slider.Callback, Slider.Value)
        end
    end
    )

    return setmetatable(Slider, LibraryV2)
end

function LibraryV2:Update_(a_1, ...)
    local Class = self.Class;

    if not a_1 then return end;
    if Class == "Button" then
        self.Callback = a_1;
    elseif Class == "Toggle" then
        self.State = a_1;
        self.Update();
    
        task.spawn(function()
            pcall(self.Callback, self.State)
        end)
    elseif Class == "Label" then
        self.Text = a_1;
    elseif Class == "Slider" then       
        self.Value = a_1;
    elseif Class == "Dropdown" then
        self.List = a_1;
    end

    self.Update();
end

function LibraryV2:UpdateNotifications()

    --// GET RID OF THE LOSER NOTIFICATIONS LOL
    for i,v in pairs(LibraryV2.Notifications) do
        if (tick()-v.Data.TOC) >= v.Data.Last then
            --// Remove
            --inst, tType, t, yield, pref
            local Notif = v.Data.Notification
            Tween(Notif, {Position = u2(1, Notif.Position.X.Offset, Notif.Position.Y.Scale, Notif.Position.Y.Offset)}, 0.55)
            
            delay(0.55, function()
				Notif:Destroy()
			end)
            table.remove(LibraryV2.Notifications, i)
        end
    end

	if #LibraryV2.Notifications > 1 then
		table.sort(LibraryV2.Notifications, function(a, b)
			return a.Data.Queue < b.Data.Queue
		end)
	end

    for i,v in ipairs(LibraryV2.Notifications) do
        --Let's determine if its a new notification or already tweened
        local Move_Axis = (0.902 - (0.1 * (i-1)))
        if v.Data.Notification.Position.X.Scale == 1 then
            -- New
            v.Data.Notification.Position = u2(1, v.Data.Notification.Position.X.Offset, Move_Axis, v.Data.Notification.Position.Y.Offset)
            Tween(v.Data.Notification, {Position = u2(0.825, v.Data.Notification.Position.X.Offset, Move_Axis, v.Data.Notification.Position.Y.Offset)}, 0.5)
        else
            -- Old
            Tween(v.Data.Notification, {Position = u2(0.825, v.Data.Notification.Position.X.Offset, Move_Axis, v.Data.Notification.Position.Y.Offset)}, 0.5)
        end
    end
end

function LibraryV2:Notification(Title, Info, Icon, Last)
    if #LibraryV2.Notifications >= 5 then
        print("You have too many notifications ongoing.")
        return
    end

    local Notification
    Notification = {

        Title = Title or "None",
        Info = Info or "No Info",
        Icon = Icon and "rbxassetid://" .. Icon or "rbxassetid://6031071053",

        Data = {
            Queue = #LibraryV2.Notifications+1,
            Notification = GetAsset("Notification"):Clone(),
            TOC = tick(),
            Last = Last or 3
        }
    }
    Notification.Data.Notification.Name = Notification.Data.Queue
    Notification.Data.Notification.Bottom.Text = Notification.Info
    Notification.Data.Notification.Top.Text = Notification.Title
    Notification.Data.Notification.Icon.Image = Notification.Icon
    Notification.Data.Notification.Parent = GetAsset("Notifications")
    table.insert(LibraryV2.Notifications, Notification)

    delay(Last+0.05, function()
        LibraryV2:UpdateNotifications()
    end)
    LibraryV2:UpdateNotifications()
end

function LibraryV2:SetToggleKey(Key)
    delay(0.05, function()
      self.ToggleKey = Key
    end)
end

return LibraryV2
