-- Clean UI Library - на основе ZOV.lua без виджетов
LibraryV2 = {}
LibraryV2.__index = LibraryV2
LibraryV2.Notifications = {}

local TweenService = game:GetService("TweenService")
local u2 = UDim2.new

function Tween(inst, tType, t, yield, pref)
    local Tween = TweenService:Create(inst, TweenInfo.new(pref and pref or t and t or 1), tType)
    Tween:Play()
    if yield then
        Tween.Completed:Wait()
    end
end

function RoundNumber(num, numDecimalPlaces)
    return tonumber(string.format("%." .. (numDecimalPlaces or 0) .. "f", num))
end

function Ripple(asset, x, y)
    coroutine.resume(coroutine.create(function()
         local New_Ripple = Instance.new("ImageLabel")
         New_Ripple.BackgroundTransparency = 1
         New_Ripple.ImageTransparency = 0.6
         New_Ripple.Image = "rbxassetid://266543268"
         New_Ripple.Parent = asset
         New_Ripple.Position = u2(0, (x-asset.AbsolutePosition.X), 0, (y-asset.AbsolutePosition.Y-36))
         New_Ripple.Size = u2(0, 0, 0, 0)

         local Size = asset.AbsoluteSize.X >= asset.AbsoluteSize.Y and asset.AbsoluteSize.X * 1.5 or asset.AbsoluteSize.Y * 1.5
         local Tween = TweenService:Create(New_Ripple, TweenInfo.new(0.6, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {
            Size = u2(0, Size, 0, Size),
            Position = u2(0.5, (-Size / 2), 0.5, (-Size / 2)),
            ImageTransparency = 1
         })
         Tween:Play()
         Tween.Completed:Wait()
         New_Ripple:Destroy()
    end))
end

function LibraryV2.UI(Name)
    local Library = {
        Name = Name or "UI",
        Tabs = {},
        State = true,
        ToggleKey = Enum.KeyCode.LeftControl,
        
        _UI = Instance.new("ScreenGui"),
        Lib = Instance.new("Frame")
    }
    
    Library._UI.Name = "CleanUI"
    Library._UI.ResetOnSpawn = false
    Library._UI.Parent = game.CoreGui
    
    Library.Lib.Name = "Lib"
    Library.Lib.Size = u2(0, 450, 0, 500)
    Library.Lib.Position = u2(0.5, -225, 0.5, -250)
    Library.Lib.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
    Library.Lib.BorderSizePixel = 0
    Library.Lib.Parent = Library._UI
    
    local Corner = Instance.new("UICorner")
    Corner.CornerRadius = UDim.new(0, 8)
    Corner.Parent = Library.Lib
    
    local Title = Instance.new("TextLabel")
    Title.Name = "Title"
    Title.Size = u2(1, 0, 0, 40)
    Title.BackgroundColor3 = Color3.fromRGB(20, 20, 25)
    Title.BorderSizePixel = 0
    Title.Text = Library.Name
    Title.TextColor3 = Color3.fromRGB(255, 255, 255)
    Title.Font = Enum.Font.GothamBold
    Title.TextSize = 16
    Title.Parent = Library.Lib
    
    local TitleCorner = Instance.new("UICorner")
    TitleCorner.CornerRadius = UDim.new(0, 8)
    TitleCorner.Parent = Title
    
    local Holder = Instance.new("ScrollingFrame")
    Holder.Name = "Holder"
    Holder.Size = u2(1, -20, 1, -60)
    Holder.Position = u2(0, 10, 0, 50)
    Holder.BackgroundTransparency = 1
    Holder.BorderSizePixel = 0
    Holder.ScrollBarThickness = 4
    Holder.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 120)
    Holder.Parent = Library.Lib
    
    local Layout = Instance.new("UIListLayout")
    Layout.Padding = UDim.new(0, 8)
    Layout.SortOrder = Enum.SortOrder.LayoutOrder
    Layout.Parent = Holder
    
    Layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        Holder.CanvasSize = u2(0, 0, 0, Layout.AbsoluteContentSize.Y + 10)
    end)
    
    Library._UI.Lib = Library.Lib
    Library._UI.Lib.Holder = Holder
    
    -- Draggable
    local dragging, dragInput, dragStart, startPos
    
    Title.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = Library.Lib.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    Title.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)
    
    game:GetService("UserInputService").InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            Library.Lib.Position = u2(
                startPos.X.Scale, startPos.X.Offset + delta.X,
                startPos.Y.Scale, startPos.Y.Offset + delta.Y
            )
        end
    end)
    
    game:GetService("UserInputService").InputBegan:Connect(function(Key, IsTyping)
        if IsTyping then return end
        if Key.KeyCode == Library.ToggleKey then
            Library.State = not Library.State
            Library._UI.Enabled = Library.State
        end
    end)
    
    return setmetatable(Library, LibraryV2)
end

function LibraryV2:Container(Name)
    local Container = {
        Name = Name,
        Assets = {},
        Drops = {},
        Tweens = {},
        State = false,
        Container = Instance.new("Frame")
    }
    
    Container.Container.Name = Name
    Container.Container.Size = u2(0, 340, 0, 35)
    Container.Container.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
    Container.Container.BorderSizePixel = 0
    Container.Container.Parent = self._UI.Lib.Holder
    
    local ContainerCorner = Instance.new("UICorner")
    ContainerCorner.CornerRadius = UDim.new(0, 6)
    ContainerCorner.Parent = Container.Container
    
    local TextLabel = Instance.new("TextLabel")
    TextLabel.Name = "TextLabel"
    TextLabel.Size = u2(1, -30, 0, 35)
    TextLabel.BackgroundTransparency = 1
    TextLabel.Text = "  " .. Name
    TextLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    TextLabel.Font = Enum.Font.GothamSemibold
    TextLabel.TextSize = 14
    TextLabel.TextXAlignment = Enum.TextXAlignment.Left
    TextLabel.Parent = Container.Container
    
    local ImageLabel = Instance.new("TextLabel")
    ImageLabel.Name = "ImageLabel"
    ImageLabel.Size = u2(0, 20, 0, 35)
    ImageLabel.Position = u2(1, -25, 0, 0)
    ImageLabel.BackgroundTransparency = 1
    ImageLabel.Text = "▼"
    ImageLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
    ImageLabel.Font = Enum.Font.GothamBold
    ImageLabel.TextSize = 12
    ImageLabel.Rotation = 0
    ImageLabel.Parent = Container.Container
    
    local ScrollingFrame = Instance.new("Frame")
    ScrollingFrame.Name = "ScrollingFrame"
    ScrollingFrame.Size = u2(1, -10, 0, 0)
    ScrollingFrame.Position = u2(0, 5, 0, 40)
    ScrollingFrame.BackgroundTransparency = 1
    ScrollingFrame.ClipsDescendants = true
    ScrollingFrame.Parent = Container.Container
    
    local ScrollLayout = Instance.new("UIListLayout")
    ScrollLayout.Padding = UDim.new(0, 5)
    ScrollLayout.SortOrder = Enum.SortOrder.LayoutOrder
    ScrollLayout.Parent = ScrollingFrame
    
    Container.ScrollingFrame = ScrollingFrame
    Container.Layout = ScrollLayout
    
    Container.CancelTweens = function()
        for i, tween in pairs(Container.Tweens) do
            tween:Cancel()
            table.remove(Container.Tweens, i)
        end
    end
    
    Container.Update = function()
        Container.Container.TextLabel.Text = "  " .. Container.Name
    end
    
    Container.In = function()
        Container.CancelTweens()
        Tween(ImageLabel, {Rotation = 0}, 0.3)
        local Tween = TweenService:Create(Container.Container, TweenInfo.new(0.3, Enum.EasingStyle.Quint), {Size = u2(0, 340, 0, 35)})
        Tween:Play()
        
        for i,v in pairs(Container.Assets) do
            v.Visible = false
        end
        
        table.insert(Container.Tweens, Tween)
    end
    
    Container.Out = function()
        Container.CancelTweens()
        Tween(ImageLabel, {Rotation = 180}, 0.3)
        
        for i,v in pairs(Container.Assets) do
            v.Visible = true
        end
        
        local targetSize = 45 + (ScrollLayout.AbsoluteContentSize.Y > 0 and ScrollLayout.AbsoluteContentSize.Y + 10 or 0)
        local Tween = TweenService:Create(Container.Container, TweenInfo.new(0.3, Enum.EasingStyle.Quint), {Size = u2(0, 340, 0, targetSize)})
        Tween:Play()
        
        TweenService:Create(ScrollingFrame, TweenInfo.new(0.3, Enum.EasingStyle.Quint), {
            Size = u2(1, -10, 0, ScrollLayout.AbsoluteContentSize.Y)
        }):Play()
        
        table.insert(Container.Tweens, Tween)
    end
    
    Container.Update()
    
    ImageLabel.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            if Container.State then
                Container.In()
            else
                Container.Out()
            end
            Container.State = not Container.State
        end
    end)
    
    ScrollLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        if Container.State then
            local targetSize = 45 + ScrollLayout.AbsoluteContentSize.Y + 10
            Container.Container.Size = u2(0, 340, 0, targetSize)
            ScrollingFrame.Size = u2(1, -10, 0, ScrollLayout.AbsoluteContentSize.Y)
        end
    end)
    
    return setmetatable(Container, LibraryV2)
end

function LibraryV2:Button(Name, Callback)
    local Button = {
        Name = Name,
        Callback = Callback or function() end,
        Asset = Instance.new("TextButton")
    }
    
    Button.Asset.Name = Name
    Button.Asset.Size = u2(1, 0, 0, 30)
    Button.Asset.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
    Button.Asset.Text = "  " .. Name
    Button.Asset.TextColor3 = Color3.fromRGB(255, 255, 255)
    Button.Asset.Font = Enum.Font.Gotham
    Button.Asset.TextSize = 13
    Button.Asset.TextXAlignment = Enum.TextXAlignment.Left
    Button.Asset.BorderSizePixel = 0
    Button.Asset.Visible = false
    Button.Asset.Parent = self.ScrollingFrame
    
    local Corner = Instance.new("UICorner")
    Corner.CornerRadius = UDim.new(0, 4)
    Corner.Parent = Button.Asset
    
    table.insert(self.Assets, Button.Asset)
    
    Button.Asset.MouseButton1Down:Connect(function(X, Y)
        pcall(Button.Callback)
        Ripple(Button.Asset, X, Y)
    end)
    
    return setmetatable(Button, LibraryV2)
end

function LibraryV2:Toggle(Name, StartingState, Callback, RunOnStart)
    local Toggle = {
        Name = Name,
        State = StartingState,
        Callback = Callback or function() end,
        Asset = Instance.new("Frame")
    }
    
    Toggle.Asset.Name = Name
    Toggle.Asset.Size = u2(1, 0, 0, 30)
    Toggle.Asset.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
    Toggle.Asset.BorderSizePixel = 0
    Toggle.Asset.Visible = false
    Toggle.Asset.Parent = self.ScrollingFrame
    
    local Corner = Instance.new("UICorner")
    Corner.CornerRadius = UDim.new(0, 4)
    Corner.Parent = Toggle.Asset
    
    local Label = Instance.new("TextLabel")
    Label.Size = u2(1, -50, 1, 0)
    Label.Position = u2(0, 10, 0, 0)
    Label.BackgroundTransparency = 1
    Label.Text = Name
    Label.TextColor3 = Color3.fromRGB(255, 255, 255)
    Label.Font = Enum.Font.Gotham
    Label.TextSize = 13
    Label.TextXAlignment = Enum.TextXAlignment.Left
    Label.Parent = Toggle.Asset
    
    local Button = Instance.new("TextButton")
    Button.Size = u2(0, 40, 0, 20)
    Button.Position = u2(1, -45, 0.5, -10)
    Button.BackgroundColor3 = StartingState and Color3.fromRGB(100, 150, 255) or Color3.fromRGB(60, 60, 70)
    Button.Text = ""
    Button.BorderSizePixel = 0
    Button.Parent = Toggle.Asset
    
    local ButtonCorner = Instance.new("UICorner")
    ButtonCorner.CornerRadius = UDim.new(1, 0)
    ButtonCorner.Parent = Button
    
    table.insert(self.Assets, Toggle.Asset)
    
    Toggle.Update = function()
        TweenService:Create(Button, TweenInfo.new(0.2, Enum.EasingStyle.Quint), {
            BackgroundColor3 = Toggle.State and Color3.fromRGB(100, 150, 255) or Color3.fromRGB(60, 60, 70)
        }):Play()
    end
    
    Button.MouseButton1Down:Connect(function(X, Y)
        Toggle.State = not Toggle.State
        Toggle.Update()
        pcall(Toggle.Callback, Toggle.State)
        Ripple(Toggle.Asset, X, Y)
    end)
    
    if Toggle.State and RunOnStart then
        pcall(Toggle.Callback, Toggle.State)
    end
    
    return setmetatable(Toggle, LibraryV2)
end

function LibraryV2:Slider(Name, Min, Max, Start, Callback, Use_Decimals)
    local Slider = {
        Name = Name,
        Min = Min or 0,
        Max = Max or 100,
        Value = Start or 0,
        Callback = Callback or function() end,
        Asset = Instance.new("Frame")
    }
    
    Slider.Asset.Name = Name
    Slider.Asset.Size = u2(1, 0, 0, 45)
    Slider.Asset.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
    Slider.Asset.BorderSizePixel = 0
    Slider.Asset.Visible = false
    Slider.Asset.Parent = self.ScrollingFrame
    
    local Corner = Instance.new("UICorner")
    Corner.CornerRadius = UDim.new(0, 4)
    Corner.Parent = Slider.Asset
    
    local NameLabel = Instance.new("TextLabel")
    NameLabel.Name = "Name"
    NameLabel.Size = u2(1, -60, 0, 20)
    NameLabel.Position = u2(0, 10, 0, 5)
    NameLabel.BackgroundTransparency = 1
    NameLabel.Text = Name
    NameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    NameLabel.Font = Enum.Font.Gotham
    NameLabel.TextSize = 13
    NameLabel.TextXAlignment = Enum.TextXAlignment.Left
    NameLabel.Parent = Slider.Asset
    
    local Percentage = Instance.new("TextLabel")
    Percentage.Name = "Percentage"
    Percentage.Size = u2(0, 50, 0, 20)
    Percentage.Position = u2(1, -55, 0, 5)
    Percentage.BackgroundTransparency = 1
    Percentage.Text = tostring(Start)
    Percentage.TextColor3 = Color3.fromRGB(200, 200, 200)
    Percentage.Font = Enum.Font.Gotham
    Percentage.TextSize = 12
    Percentage.TextXAlignment = Enum.TextXAlignment.Right
    Percentage.Parent = Slider.Asset
    
    local SliderWhole = Instance.new("Frame")
    SliderWhole.Name = "Slider_Whole"
    SliderWhole.Size = u2(1, -20, 0, 4)
    SliderWhole.Position = u2(0, 10, 1, -12)
    SliderWhole.BackgroundColor3 = Color3.fromRGB(60, 60, 70)
    SliderWhole.BorderSizePixel = 0
    SliderWhole.Parent = Slider.Asset
    
    local SliderCorner = Instance.new("UICorner")
    SliderCorner.CornerRadius = UDim.new(1, 0)
    SliderCorner.Parent = SliderWhole
    
    local SliderBar = Instance.new("Frame")
    SliderBar.Name = "Slider"
    SliderBar.Size = u2((Start - Min) / (Max - Min), 0, 1, 0)
    SliderBar.BackgroundColor3 = Color3.fromRGB(100, 150, 255)
    SliderBar.BorderSizePixel = 0
    SliderBar.Parent = SliderWhole
    
    local SliderBarCorner = Instance.new("UICorner")
    SliderBarCorner.CornerRadius = UDim.new(1, 0)
    SliderBarCorner.Parent = SliderBar
    
    local Circle = Instance.new("Frame")
    Circle.Name = "Circle"
    Circle.Size = u2(0, 12, 0, 12)
    Circle.Position = u2(1, -6, 0.5, -6)
    Circle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    Circle.BorderSizePixel = 0
    Circle.Parent = SliderBar
    
    local CircleCorner = Instance.new("UICorner")
    CircleCorner.CornerRadius = UDim.new(1, 0)
    CircleCorner.Parent = Circle
    
    table.insert(self.Assets, Slider.Asset)
    
    Slider.Dragging = false
    
    Circle.InputBegan:Connect(function(Input)
        if Input.UserInputType == Enum.UserInputType.MouseButton1 then
            Slider.Dragging = true
        end
    end)
    
    Circle.InputEnded:Connect(function(Input)
        if Input.UserInputType == Enum.UserInputType.MouseButton1 then
            Slider.Dragging = false
        end
    end)
    
    game:GetService("UserInputService").InputChanged:Connect(function(Input)
        if Slider.Dragging and Input.UserInputType == Enum.UserInputType.MouseMovement then
            local Bound = SliderWhole.AbsoluteSize.X
            local Pos1 = u2(
                math.clamp((Input.Position.X - SliderWhole.AbsolutePosition.X) / Bound, 0, 1),
                0, 1, 0
            )
            SliderBar:TweenSize(Pos1, "Out", "Sine", 0.1, true)
            Slider.Value = (Use_Decimals and RoundNumber((((Pos1.X.Scale * Slider.Max) / Slider.Max) * (Slider.Max - Slider.Min) + Slider.Min), 1) or math.floor((((Pos1.X.Scale * Slider.Max) / Slider.Max) * (Slider.Max - Slider.Min) + Slider.Min)))
            Percentage.Text = tostring(Slider.Value)
            pcall(Slider.Callback, Slider.Value)
        end
    end)
    
    return setmetatable(Slider, LibraryV2)
end

function LibraryV2:SetToggleKey(Key)
    self.ToggleKey = Key
end

return LibraryV2
